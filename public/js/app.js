var app=angular.module("myApp",["ngRoute","homeCtrl","couponDirective"]).config(["$routeProvider",function(o){"use strict";o.when("/",{controller:"HomeCtrl"}).otherwise({redirectTo:"/"})}]);angular.module("homeCtrl",["ngDialog","ngStorage"]).controller("HomeCtrl",["$scope","ngDialog","couponsService","$log","$timeout","$localStorage",function(o,e,n,t,r,c){"use strict";o.collected=c.$default({counter:0}),o.floors=c.$default({floorsArray:[]}),o.currentCouponEl={},o.currentCouponId="",o.couponMessages=[],o.coupons=[],o.couponsOnStage=[],o.callMeHover2=!1,o.init=function(){o.getCouponMessages(),o.getCoupons(),o.skrollr()},o.getLocation=function(o){var e=$(".js-house").width(),n=($(".js-house").height(),o.pageX),t=o.pageY;console.info(n/e*100+"%, "+t+"px")},o.callMeShow=function(){console.log("mouse over");var e=o.$on("mouseover",function(){console.log("unregister mouse over")});e(),e(),r(function(){o.callMeHover2=!0},0)},o.callMeHide=function(){r(function(){o.callMeHover2=!1},500)},o.hideIt=function(){r(function(){o.hovering=!1},500)},o.getCouponMessages=function(){n.getMessages().then(function(e){o.couponMessages=e},function(o){t.error(o)})},o.getCoupons=function(){n.getAllCoupons().then(function(e){o.coupons=e,o.gambleCoupons()},function(o){t.error(o)})},o.random=function(o,e){return Math.floor(Math.random()*(e-o+1))+o},o.gambleCoupons=function(){var e=(o.coupons.length,[]);_.each(o.coupons,function(o,n){e.push(n+1)}),o.actualFloors=_.difference(e,o.floors.floorsArray);for(var n=0;n<o.actualFloors.length;n++){var t=o.coupons[o.actualFloors[n]-1].coupons.length-1,r=o.random(0,t),c=o.coupons[o.actualFloors[n]-1].coupons[r];c.floor=o.actualFloors[n],o.couponsOnStage.push(c)}},o.skrollr=function(){skrollr.init({smoothScrolling:!1,mobileDeceleration:.004})},o.openCollectModal=function(){e.open({template:"views/modals/coupon.html",preCloseCallback:function(){o.currentCouponEl.fadeOut("slow")},scope:o,className:"ngdialog ngdialog_coupon ngdialog-theme-default"})},o.discount=function(){return 2*o.collected.counter},o.menuToggle=function(){this.menuState=!this.menuState},o.collect=function(e,n){o.currentCouponEl=$(n.currentTarget),o.currentCouponId=e,o.collected.counter++,o.currentCouponEl.find(".js-coupon").addClass("collected"),o.openCollectModal(),o.floors.floorsArray.push(o.currentCouponId)},o.init()}]),angular.module("couponDirective",[]).controller("couponCtrl",["$scope",function(){"use strict"}]).directive("coupon",[function(){"use strict";return{restrict:"E",templateUrl:"views/coupon/index.html",scope:{},replace:!0,link:function(o,e,n){var t=n.location.split(","),r=$.trim(t[0]),c=$.trim(t[1]);o.id=n.id,o.floor=n.floor,o.img=n.img,e.css({left:r,top:c})}}}]),app.service("couponsService",["$http","$q",function(o,e){var n=this;return n.couponMessages={},n.coupons=[],n.getMessages=function(){var t=e.defer();return o.get("data/coupon-messages.json").success(function(o){n.couponMessages=o,t.resolve(o)}).error(function(o){t.reject(o)}),t.promise},n.getAllCoupons=function(){var t=e.defer();return o.get("data/coupons.json").success(function(o){n.coupons=o,t.resolve(o)}).error(function(o){t.reject(o)}),t.promise},n}]);
//# sourceMappingURL=../js/app.js.map