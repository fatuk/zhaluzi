var app=angular.module("myApp",["ngRoute","homeCtrl","couponDirective"]).config(["$routeProvider",function(o){"use strict";o.when("/",{controller:"HomeCtrl"}).otherwise({redirectTo:"/"})}]);angular.module("homeCtrl",["ngDialog","ngStorage"]).controller("HomeCtrl",["$scope","ngDialog","couponsService","$log","$timeout","$localStorage",function(o,n,e,t,r,c){"use strict";o.collected=c.$default({counter:0}),o.floors=c.$default({floorsArray:[]}),o.currentCouponEl={},o.currentCouponId="",o.couponMessages=[],o.coupons=[],o.couponsOnStage=[],o.callMeHover2=!1,o.init=function(){o.setCouponsContainerWidth(),o.getCouponMessages(),o.getCoupons(),o.skrollr()},o.setCouponsContainerWidth=function(){var o=$(".js-couponsContainer");o.css({width:$(window).width()})},o.getLocation=function(o){var n=$(".js-couponsContainer"),e=n.width(),t=($("body").height(),o.pageX),r=o.pageY;console.info(t/e*100+"%, "+r+"px")},o.getCouponMessages=function(){e.getMessages().then(function(n){o.couponMessages=n},function(o){t.error(o)})},o.getCoupons=function(){e.getAllCoupons().then(function(n){o.coupons=n,o.gambleCoupons()},function(o){t.error(o)})},o.random=function(o,n){return Math.floor(Math.random()*(n-o+1))+o},o.gambleCoupons=function(){var n=(o.coupons.length,[]);_.each(o.coupons,function(o,e){n.push(e+1)}),o.actualFloors=_.difference(n,o.floors.floorsArray);for(var e=0;e<o.actualFloors.length;e++){var t=o.coupons[o.actualFloors[e]-1].coupons.length-1,r=o.random(0,t),c=o.coupons[o.actualFloors[e]-1].coupons[r];c.floor=o.actualFloors[e],o.couponsOnStage.push(c)}},o.skrollr=function(){skrollr.init({smoothScrolling:!1,mobileDeceleration:.004})},o.openCollectModal=function(){n.open({template:"views/modals/coupon.html",preCloseCallback:function(){o.currentCouponEl.fadeOut("slow")},scope:o,className:"ngdialog ngdialog_coupon ngdialog-theme-default"})},o.discount=function(){return 2*o.collected.counter},o.menuToggle=function(){this.menuState=!this.menuState},o.collect=function(n,e){o.currentCouponEl=$(e.currentTarget),o.currentCouponId=n,o.collected.counter++,o.currentCouponEl.find(".js-coupon").addClass("collected"),o.openCollectModal(),o.floors.floorsArray.push(o.currentCouponId)},o.init()}]),angular.module("couponDirective",[]).controller("couponCtrl",["$scope",function(){"use strict"}]).directive("coupon",[function(){"use strict";return{restrict:"E",templateUrl:"views/coupon/index.html",scope:{},replace:!0,link:function(o,n,e){var t=e.location.split(","),r=$.trim(t[0]),c=$.trim(t[1]);o.id=e.id,o.floor=e.floor,o.img=e.img,o.type=e.type,n.css({left:r,top:c})}}}]),app.service("couponsService",["$http","$q",function(o,n){var e=this;return e.couponMessages={},e.coupons=[],e.getMessages=function(){var t=n.defer();return o.get("data/coupon-messages.json").success(function(o){e.couponMessages=o,t.resolve(o)}).error(function(o){t.reject(o)}),t.promise},e.getAllCoupons=function(){var t=n.defer();return o.get("data/coupons.json").success(function(o){e.coupons=o,t.resolve(o)}).error(function(o){t.reject(o)}),t.promise},e}]);
//# sourceMappingURL=../js/app.js.map