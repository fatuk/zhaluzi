var app=angular.module("myApp",["ngRoute","homeCtrl","couponDirective","perfect_scrollbar"]).config(["$routeProvider",function(o){"use strict";o.when("/",{controller:"HomeCtrl"}).otherwise({redirectTo:"/"})}]);angular.module("homeCtrl",["ngDialog","ngStorage","angular-inview"]).controller("HomeCtrl",["$scope","ngDialog","couponsService","$log","$timeout","$localStorage",function(o,e,t,n,l,r){"use strict";o.collected=r.$default({counter:0}),o.floors=r.$default({floorsArray:[]}),o.currentCouponEl={},o.currentCouponId="",o.couponMessages=[],o.coupons=[],o.couponsOnStage=[],o.callMeHover2=!1,o.init=function(){o.setCouponsContainerWidth(),o.getCouponMessages(),o.getCoupons(),o.skrollr(),o.map()},o.openTooltipModal=function(){e.open({template:"views/modals/tooltip.html",scope:o,className:"ngdialog ngdialog_tooltip ngdialog-theme-default"})},o.map=function(){$(".js-map").gmap3({marker:{latLng:[55.762024,37.559649],options:{animation:"DROP",icon:{url:"../img/pin.svg"}}},map:{options:{center:[55.759534,37.652598],zoom:13,mapTypeControl:!1,panControl:!1,ZoomControlOptions:!1,navigationControl:!1,scrollwheel:!1,disableDefaultUI:!0,streetViewControl:!1,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}]}}})},o.wow=function(){(new WOW).init()},o.setCouponsContainerWidth=function(){var o=$(".js-couponsContainer");o.css({width:$(window).width()})},o.getLocation=function(o){var e=$(".js-couponsContainer"),t=e.width(),n=($("body").height(),o.pageX),l=o.pageY;console.info(n/t*100+"%, "+l+"px")},o.getCouponMessages=function(){t.getMessages().then(function(e){o.couponMessages=e},function(o){n.error(o)})},o.getCoupons=function(){t.getAllCoupons().then(function(e){o.coupons=e,o.gambleCoupons()},function(o){n.error(o)})},o.random=function(o,e){return Math.floor(Math.random()*(e-o+1))+o},o.gambleCoupons=function(){var e=(o.coupons.length,[]);_.each(o.coupons,function(o,t){e.push(t+1)}),o.actualFloors=_.difference(e,o.floors.floorsArray);for(var t=0;t<o.actualFloors.length;t++){var n=o.coupons[o.actualFloors[t]-1].coupons.length-1,l=o.random(0,n),r=o.coupons[o.actualFloors[t]-1].coupons[l];r.floor=o.actualFloors[t],o.couponsOnStage.push(r)}},o.skrollr=function(){skrollr.init({smoothScrolling:!1,mobileDeceleration:.004})},o.openCollectModal=function(){e.open({template:"views/modals/coupon.html",preCloseCallback:function(){o.currentCouponEl.fadeOut("slow")},scope:o,className:"ngdialog ngdialog_coupon ngdialog-theme-default"})},o.discount=function(){return 2*o.collected.counter},o.menuToggle=function(){this.menuState=!this.menuState},o.collect=function(e,t){o.currentCouponEl=$(t.currentTarget),o.currentCouponId=e,o.collected.counter++,o.currentCouponEl.find(".js-coupon").addClass("collected"),o.openCollectModal(),o.floors.floorsArray.push(o.currentCouponId)},o.init()}]),angular.module("couponDirective",[]).controller("couponCtrl",["$scope",function(){"use strict"}]).directive("coupon",[function(){"use strict";return{restrict:"E",templateUrl:"views/coupon/index.html",scope:{},replace:!0,link:function(o,e,t){var n=t.location.split(","),l=$.trim(n[0]),r=$.trim(n[1]);o.id=t.id,o.floor=t.floor,o.img=t.img,o.type=t.type,e.css({left:l,top:r})}}}]),app.service("couponsService",["$http","$q",function(o,e){var t=this;return t.couponMessages={},t.coupons=[],t.getMessages=function(){var n=e.defer();return o.get("data/coupon-messages.json").success(function(o){t.couponMessages=o,n.resolve(o)}).error(function(o){n.reject(o)}),n.promise},t.getAllCoupons=function(){var n=e.defer();return o.get("data/coupons.json").success(function(o){t.coupons=o,n.resolve(o)}).error(function(o){n.reject(o)}),n.promise},t}]);
//# sourceMappingURL=../js/app.js.map