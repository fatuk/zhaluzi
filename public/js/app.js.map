{"version":3,"sources":["app.js","controllers/homeCtrl.js","directives/couponDirective.js","services/couponsService.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["/**\n * App Module\n *\n * Main app module\n */\nvar app = angular.module('myApp', [\n\t'ngRoute',\n\t'homeCtrl',\n\t'couponDirective',\n\t'perfect_scrollbar'\n])\n\t.config(['$routeProvider',\n\t\tfunction ($routeProvider) {\n\t\t\t'use strict';\n\t\t\t$routeProvider\n\t\t\t\t.when('/', {\n\t\t\t\t\tcontroller: 'HomeCtrl'\n\t\t\t\t})\n\t\t\t\t.otherwise({\n\t\t\t\t\tredirectTo: '/'\n\t\t\t\t});\n\t\t}\n\t]);\n","angular.module('homeCtrl', ['ngDialog', 'ngStorage'])\n\t.controller('HomeCtrl', [\n\t\t'$scope',\n\t\t'ngDialog',\n\t\t'couponsService',\n\t\t'$log',\n\t\t'$timeout',\n\t\t'$localStorage',\n\t\tfunction ($scope, ngDialog, couponsService, $log, $timeout, $localStorage) {\n\t\t\t'use strict';\n\n\t\t\t$scope.collected = $localStorage.$default({\n\t\t\t\tcounter: 0\n\t\t\t});\n\t\t\t$scope.floors = $localStorage.$default({\n\t\t\t\tfloorsArray: []\n\t\t\t});\n\t\t\t$scope.currentCouponEl = {};\n\t\t\t$scope.currentCouponId = '';\n\t\t\t$scope.couponMessages = [];\n\t\t\t$scope.coupons = [];\n\t\t\t$scope.couponsOnStage = [];\n\t\t\t$scope.callMeHover2 = false;\n\n\t\t\t$scope.init = function () {\n\t\t\t\t$scope.setCouponsContainerWidth();\n\t\t\t\t$scope.getCouponMessages();\n\t\t\t\t$scope.getCoupons();\n\t\t\t\t$scope.skrollr();\n\t\t\t};\n\n\t\t\t$scope.openTooltipModal = function () {\n\t\t\t\tngDialog.open({\n\t\t\t\t\ttemplate: 'views/modals/tooltip.html',\n\t\t\t\t\tscope: $scope,\n\t\t\t\t\tclassName: 'ngdialog ngdialog_tooltip ngdialog-theme-default'\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Set coupons container width\n\t\t\t$scope.setCouponsContainerWidth = function () {\n\t\t\t\tvar $couponsContainer = $('.js-couponsContainer');\n\t\t\t\t$couponsContainer.css({\n\t\t\t\t\twidth: $(window).width()\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// For points position adjusting\n\t\t\t$scope.getLocation = function (e) {\n\t\t\t\tvar $couponsContainer = $('.js-couponsContainer'),\n\t\t\t\t\twidth = $couponsContainer.width(),\n\t\t\t\t\theight = $('body').height(),\n\t\t\t\t\tx = e.pageX,\n\t\t\t\t\ty = e.pageY;\n\n\t\t\t\tconsole.info(x / width * 100 + '%, ' + y + 'px');\n\t\t\t};\n\n\t\t\t$scope.getCouponMessages = function () {\n\t\t\t\tcouponsService.getMessages()\n\t\t\t\t\t.then(function (res) {\n\t\t\t\t\t\t// Success\n\t\t\t\t\t\t$scope.couponMessages = res;\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t// Error\n\t\t\t\t\t\t$log.error(err);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.getCoupons = function () {\n\t\t\t\tcouponsService.getAllCoupons()\n\t\t\t\t\t.then(function (res) {\n\t\t\t\t\t\t// Success\n\t\t\t\t\t\t$scope.coupons = res;\n\t\t\t\t\t\t$scope.gambleCoupons();\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t// Error\n\t\t\t\t\t\t$log.error(err);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.random = function (min, max) {\n\t\t\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t\t\t};\n\n\t\t\t$scope.gambleCoupons = function () {\n\t\t\t\tvar floorsCount = $scope.coupons.length,\n\t\t\t\t\tcouponsIdArray = [];\n\n\t\t\t\t// Get coupons flat id array\n\t\t\t\t_.each($scope.coupons, function (item, i) {\n\t\t\t\t\tcouponsIdArray.push(i + 1);\n\t\t\t\t});\n\n\t\t\t\t// Get rest floors\n\t\t\t\t$scope.actualFloors = _.difference(couponsIdArray, $scope.floors.floorsArray);\n\n\t\t\t\tfor (var i = 0; i < $scope.actualFloors.length; i++) {\n\t\t\t\t\tvar max = $scope.coupons[$scope.actualFloors[i] - 1].coupons.length - 1,\n\t\t\t\t\t\trnd = $scope.random(0, max),\n\t\t\t\t\t\trandomCoupon = $scope.coupons[$scope.actualFloors[i] - 1].coupons[rnd];\n\n\t\t\t\t\trandomCoupon.floor = $scope.actualFloors[i];\n\t\t\t\t\t$scope.couponsOnStage.push(randomCoupon);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.skrollr = function () {\n\t\t\t\tvar s = skrollr.init({\n\t\t\t\t\tsmoothScrolling: false,\n\t\t\t\t\tmobileDeceleration: 0.004\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.openCollectModal = function () {\n\t\t\t\tngDialog.open({\n\t\t\t\t\ttemplate: 'views/modals/coupon.html',\n\t\t\t\t\tpreCloseCallback: function () {\n\t\t\t\t\t\t$scope.currentCouponEl.fadeOut('slow');\n\t\t\t\t\t},\n\t\t\t\t\tscope: $scope,\n\t\t\t\t\tclassName: 'ngdialog ngdialog_coupon ngdialog-theme-default'\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.discount = function () {\n\t\t\t\treturn $scope.collected.counter * 2;\n\t\t\t};\n\n\t\t\t$scope.menuToggle = function () {\n\t\t\t\tthis.menuState = !this.menuState;\n\t\t\t};\n\n\t\t\t$scope.collect = function (id, e) {\n\t\t\t\t$scope.currentCouponEl = $(e.currentTarget);\n\t\t\t\t$scope.currentCouponId = id;\n\n\t\t\t\t$scope.collected.counter++;\n\n\t\t\t\t$scope.currentCouponEl.find('.js-coupon').addClass('collected');\n\n\t\t\t\t$scope.openCollectModal();\n\n\t\t\t\t$scope.floors.floorsArray.push($scope.currentCouponId);\n\t\t\t};\n\n\t\t\t$scope.init();\n\t\t}\n\t]);\n","angular.module('couponDirective', [])\n\t.controller('couponCtrl', ['$scope',\n\t\tfunction ($scope) {\n\t\t\t'use strict';\n\t\t}\n\t])\n\t.directive('coupon', [\n\n\t\tfunction () {\n\t\t\t'use strict';\n\t\t\treturn {\n\t\t\t\trestrict: 'E',\n\t\t\t\ttemplateUrl: 'views/coupon/index.html',\n\t\t\t\tscope: {},\n\t\t\t\treplace: true,\n\t\t\t\tlink: function (scope, el, attr) {\n\t\t\t\t\tvar locationArray = attr.location.split(','),\n\t\t\t\t\t\tleft = $.trim(locationArray[0]),\n\t\t\t\t\t\ttop = $.trim(locationArray[1]);\n\n\t\t\t\t\tscope.id = attr.id;\n\t\t\t\t\tscope.floor = attr.floor;\n\t\t\t\t\tscope.img = attr.img;\n\t\t\t\t\tscope.type = attr.type;\n\n\t\t\t\t\tel.css({\n\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\ttop: top\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t]);\n","app.service('couponsService', ['$http', '$q',\n\n\tfunction ($http, $q) {\n\t\tvar coupon = this;\n\t\tcoupon.couponMessages = {};\n\t\tcoupon.coupons = [];\n\n\t\tcoupon.getMessages = function () {\n\t\t\tvar defer = $q.defer();\n\n\t\t\t$http.get('data/coupon-messages.json')\n\t\t\t\t.success(function (res) {\n\t\t\t\t\tcoupon.couponMessages = res;\n\t\t\t\t\tdefer.resolve(res);\n\t\t\t\t})\n\t\t\t\t.error(function (err, status) {\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t});\n\n\t\t\treturn defer.promise;\n\t\t};\n\n\t\tcoupon.getAllCoupons = function () {\n\t\t\tvar defer = $q.defer();\n\n\t\t\t$http.get('data/coupons.json')\n\t\t\t\t.success(function (res) {\n\t\t\t\t\tcoupon.coupons = res;\n\t\t\t\t\tdefer.resolve(res);\n\t\t\t\t})\n\t\t\t\t.error(function (err, status) {\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t});\n\n\t\t\treturn defer.promise;\n\t\t};\n\n\n\n\t\treturn coupon;\n\t}\n]);\n"],"sourceRoot":"/source/"}